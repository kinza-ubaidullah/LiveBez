generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Language {
  id                     String                       @id @default(cuid())
  code                   String                       @unique
  name                   String
  isVisible              Boolean                      @default(true)
  isSource               Boolean                      @default(false)
  createdAt              DateTime                     @default(now())
  updatedAt              DateTime                     @updatedAt
  categoryTranslations   ArticleCategoryTranslation[]
  articleTranslations    ArticleTranslation[]
  bookmakerTranslations  BookmakerTranslation[]
  leagueTranslations     LeagueTranslation[]
  matchTranslations      MatchTranslation[]
  predictionTranslations PredictionTranslation[]
  staticPageTranslations StaticPageTranslation[]
  teamTranslations       TeamTranslation[]
}

model StaticPage {
  id           String                  @id @default(cuid())
  slug         String                  @unique
  createdAt    DateTime                @default(now())
  updatedAt    DateTime                @updatedAt
  translations StaticPageTranslation[]
}

model StaticPageTranslation {
  id           String     @id @default(cuid())
  pageId       String
  languageCode String
  title        String
  content      String
  seoId        String?    @unique
  language     Language   @relation(fields: [languageCode], references: [code])
  page         StaticPage @relation(fields: [pageId], references: [id])
  seo          SeoFields? @relation(fields: [seoId], references: [id])

  @@unique([pageId, languageCode])
}

model SiteSettings {
  id               String   @id @default(cuid())
  siteName         String   @default("LiveBaz")
  defaultLocale    String   @default("en")
  globalTitle      String?
  globalDesc       String?
  globalBrandColor String   @default("#2563eb")
  headScripts      String?
  bodyScripts      String?
  updatedAt        DateTime @updatedAt
}

model SeoFields {
  id                    String                      @id @default(cuid())
  title                 String?
  description           String?
  h1                    String?
  canonical             String?
  ogTitle               String?
  ogDescription         String?
  ogImage               String?
  noIndex               Boolean                     @default(false)
  jsonLd                String?
  categoryTranslation   ArticleCategoryTranslation?
  articleTranslation    ArticleTranslation?
  bookmakerTranslation  BookmakerTranslation?
  leagueTranslation     LeagueTranslation?
  matchTranslation      MatchTranslation?
  staticPageTranslation StaticPageTranslation?
  teamTranslation       TeamTranslation?
}

model League {
  id           String              @id @default(cuid())
  apiId        String?             @unique
  country      String
  logoUrl      String?
  createdAt    DateTime            @default(now())
  updatedAt    DateTime            @updatedAt
  isFeatured   Boolean             @default(false)
  articles     Article[]
  translations LeagueTranslation[]
  matches      Match[]
  standings    String?
}

model LeagueTranslation {
  id           String    @id @default(cuid())
  leagueId     String
  languageCode String
  slug         String    @unique
  name         String
  description  String?
  isActive     Boolean   @default(true)
  seoId        String    @unique
  language     Language  @relation(fields: [languageCode], references: [code])
  league       League    @relation(fields: [leagueId], references: [id])
  seo          SeoFields @relation(fields: [seoId], references: [id])

  @@unique([leagueId, languageCode])
}

model Match {
  id              String             @id @default(cuid())
  date            DateTime
  homeTeam        String
  awayTeam        String
  homeScore       Int?
  awayScore       Int?
  leagueId        String
  status          String             @default("SCHEDULED")
  minute          Int?
  apiSportsId     String?
  lineups         String?
  stats           String?
  homeTeamLogo    String?
  awayTeamLogo    String?
  mainTip         String?
  confidence      Int?
  isFeatured      Boolean            @default(false)
  createdAt       DateTime           @default(now())
  updatedAt       DateTime           @updatedAt
  h2h             String?
  events          String?
  awayTeamId      String?
  homeTeamId      String?
  comparison      String?
  predictionsFull String?
  articles        Article[]
  awayTeamRel     Team?              @relation("AwayTeam", fields: [awayTeamId], references: [id])
  homeTeamRel     Team?              @relation("HomeTeam", fields: [homeTeamId], references: [id])
  league          League             @relation(fields: [leagueId], references: [id])
  translations    MatchTranslation[]
  prediction      Prediction?
}

model MatchTranslation {
  id           String        @id @default(cuid())
  matchId      String
  languageCode String
  slug         String        @unique
  name         String
  content      String?
  analysis     String?
  isActive     Boolean       @default(true)
  seoId        String        @unique
  status       ContentStatus @default(DRAFT)
  language     Language      @relation(fields: [languageCode], references: [code])
  match        Match         @relation(fields: [matchId], references: [id])
  seo          SeoFields     @relation(fields: [seoId], references: [id])

  @@unique([matchId, languageCode])
}

model Prediction {
  id           String                  @id @default(cuid())
  matchId      String                  @unique
  winProbHome  Float
  winProbAway  Float
  winProbDraw  Float
  createdAt    DateTime                @default(now())
  updatedAt    DateTime                @updatedAt
  bttsProb     Float?                  @default(50)
  overProb     Float?                  @default(50)
  underProb    Float?                  @default(50)
  isManual     Boolean                 @default(false)
  match        Match                   @relation(fields: [matchId], references: [id])
  translations PredictionTranslation[]
}

model PredictionTranslation {
  id           String     @id @default(cuid())
  predictionId String
  languageCode String
  analysis     String
  language     Language   @relation(fields: [languageCode], references: [code])
  prediction   Prediction @relation(fields: [predictionId], references: [id])

  @@unique([predictionId, languageCode])
}

model Article {
  id            String               @id @default(cuid())
  categoryId    String
  published     Boolean              @default(false)
  featuredImage String?
  createdAt     DateTime             @default(now())
  updatedAt     DateTime             @updatedAt
  isFeatured    Boolean              @default(false)
  leagueId      String?
  matchId       String?
  category      ArticleCategory      @relation(fields: [categoryId], references: [id])
  league        League?              @relation(fields: [leagueId], references: [id])
  match         Match?               @relation(fields: [matchId], references: [id])
  translations  ArticleTranslation[]
  tags          Tag[]                @relation("ArticleToTag")
}

model ArticleCategory {
  id           String                       @id @default(cuid())
  key          String                       @unique
  createdAt    DateTime                     @default(now())
  updatedAt    DateTime                     @updatedAt
  articles     Article[]
  translations ArticleCategoryTranslation[]
}

model ArticleCategoryTranslation {
  id           String          @id @default(cuid())
  categoryId   String
  languageCode String
  slug         String          @unique
  name         String
  description  String?
  seoId        String          @unique
  category     ArticleCategory @relation(fields: [categoryId], references: [id])
  language     Language        @relation(fields: [languageCode], references: [code])
  seo          SeoFields       @relation(fields: [seoId], references: [id])

  @@unique([categoryId, languageCode])
}

model Tag {
  id       String    @id @default(cuid())
  name     String    @unique
  slug     String    @unique
  articles Article[] @relation("ArticleToTag")
}

model ArticleTranslation {
  id           String    @id @default(cuid())
  articleId    String
  languageCode String
  slug         String    @unique
  title        String
  content      String
  excerpt      String?
  isActive     Boolean   @default(true)
  seoId        String    @unique
  article      Article   @relation(fields: [articleId], references: [id])
  language     Language  @relation(fields: [languageCode], references: [code])
  seo          SeoFields @relation(fields: [seoId], references: [id])

  @@unique([articleId, languageCode])
}

model AdminUser {
  id        String   @id @default(cuid())
  email     String   @unique
  password  String
  name      String?
  role      String   @default("ADMIN")
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model AppUser {
  id                 String    @id @default(cuid())
  email              String    @unique
  password           String
  name               String?
  emailVerified      DateTime?
  image              String?
  createdAt          DateTime  @default(now())
  updatedAt          DateTime  @updatedAt
  verificationCode   String?
  verificationExpiry DateTime?
  isVerified         Boolean   @default(false)
}

model Bookmaker {
  id           String                 @id @default(cuid())
  logoUrl      String?
  rating       Float                  @default(5.0)
  createdAt    DateTime               @default(now())
  updatedAt    DateTime               @updatedAt
  isActive     Boolean                @default(true)
  isDoFollow   Boolean                @default(false)
  translations BookmakerTranslation[]
}

model BookmakerTranslation {
  id           String    @id @default(cuid())
  bookmakerId  String
  languageCode String
  name         String
  bonusText    String
  affiliateUrl String
  description  String?
  sampleOdds   String?
  seoId        String    @unique
  slug         String    @unique
  bookmaker    Bookmaker @relation(fields: [bookmakerId], references: [id])
  language     Language  @relation(fields: [languageCode], references: [code])
  seo          SeoFields @relation(fields: [seoId], references: [id])

  @@unique([bookmakerId, languageCode])
}

model SyncLog {
  id        String   @id @default(cuid())
  type      String
  status    String
  count     Int      @default(0)
  createdAt DateTime @default(now())
}

model PushSubscription {
  id        String   @id @default(cuid())
  endpoint  String   @unique
  p256dh    String
  auth      String
  userId    String?
  matchId   String?
  createdAt DateTime @default(now())
}

model Team {
  id           String            @id @default(cuid())
  apiId        String?           @unique
  logoUrl      String?
  country      String?
  createdAt    DateTime          @default(now())
  updatedAt    DateTime          @updatedAt
  awayMatches  Match[]           @relation("AwayTeam")
  homeMatches  Match[]           @relation("HomeTeam")
  translations TeamTranslation[]
}

model TeamTranslation {
  id           String    @id @default(cuid())
  teamId       String
  languageCode String
  slug         String    @unique
  name         String
  description  String?
  seoId        String    @unique
  language     Language  @relation(fields: [languageCode], references: [code])
  seo          SeoFields @relation(fields: [seoId], references: [id])
  team         Team      @relation(fields: [teamId], references: [id])

  @@unique([teamId, languageCode])
}

enum ContentStatus {
  DRAFT
  PUBLISHED
  REJECTED
}
